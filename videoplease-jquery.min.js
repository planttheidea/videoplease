/*
 *
 * Copyright 2014 Tony Quetano under the terms of the MIT
 * license found at https://github.com/planttheidea/bolster/MIT_License.txt
 *
 * videoplease-jquery.js - The jQuery version of a plugin to generate bulletproof video that works back to IE8
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
*/
(function(B,l){function r(a,c){var b=c||{},f=h.video.cloneNode(!1),l=h.source.cloneNode(!1),n=h.source.cloneNode(!1),p=h.source.cloneNode(!1),q=h.object.cloneNode(!1),r=h.param.cloneNode(!1),u=h.param.cloneNode(!1),v=h.param.cloneNode(!1);h.param.cloneNode(!1);f.canPlayType||(f.style.display="block");f.className="VideoPlease";this.length=0;this.elements=[];this.players=[];this.isActive=[];for(var d=0;d<a.length;d++){var e=f.cloneNode(!0),s=l.cloneNode(!1),w=n.cloneNode(!1),x=p.cloneNode(!1),k=q.cloneNode(!1),
y=r.cloneNode(!1),z=u.cloneNode(!1),A=v.cloneNode(!1);if(c){e.setAttribute("data-index",d);e.className+=" VideoPlease"+d;e.setAttribute("preload",b.preload||t.preload);e.setAttribute("controls",b.controls||t.controls);g({target:e,name:"preload",value:b.preload,index:d});g({target:e,name:"autoplay",value:b.autoplay,index:d});g({target:e,name:"id",value:b.id,index:d});g({target:e,name:"width",value:b.width,index:d});g({target:e,name:"height",value:b.height,index:d});b.className&&("array"===$.type(b.className)?
m(b.className[d])||(e.className+=b.className[d]):e.className+=b.className);g({target:e,name:"poster",value:b.poster,index:d});g({target:s,name:"src",value:b.mp4,index:d})&&(s.type="video/mp4",e.appendChild(s));g({target:w,name:"src",value:b.webm,index:d})&&(w.type="video/webm",e.appendChild(w));g({target:x,name:"src",value:b.ogg,index:d})&&(x.type="video/ogg",e.appendChild(x));if(s=m(b.flashFallback)?t.flashFallback:"array"===$.type(b.flashFallback)?m(b.flashFallback[d])?t.flashFallback:b.flashFallback[d]:
b.flashFallback)y.setAttribute("name","allowfullscreen"),y.setAttribute("value",!0),z.setAttribute("name","allowscriptaccess"),z.setAttribute("value","always"),A.setAttribute("name","flashvars"),m(b.swf)||g({target:k,name:"data",value:b.swf,index:d}),g({target:k,name:"width",value:b.width,index:d}),g({target:k,name:"height",value:b.height,index:d}),e.appendChild(k),k.setAttribute("type","application/x-shockwave-flash"),k.appendChild(y),k.appendChild(z),g({target:A,name:"value",value:b.mp4,prefix:"file=",
index:d})&&k.appendChild(A);this.players.push(e);this.elements.push(a[d]);this.isActive.push(!1);this.length++}else throw Error("Must pass in parameters to create video element.");}return this}var m=function(a){return"undefined"===$.type(a)},g=function(a){var c=!0;m(a.value)?c=!1:"array"===$.type(a.value)?m(a.value[a.index])?c=!1:a.target.setAttribute(a.name,(a.prefix||"")+a.value[a.index]):a.target.setAttribute(a.name,a.value);return c},h={video:l.createElement("video"),source:l.createElement("source"),
object:l.createElement("object"),param:l.createElement("param")},t={preload:"auto",controls:"controls",autoplay:!1,flashFallback:!0},p=function(a){this.isActive[a]&&(this.players[a].parentNode.replaceChild(this.elements[a],this.players[a]),this.isActive[a]=!1);return this},q=function(a){this.isActive[a]||(this.elements[a].parentNode.replaceChild(this.players[a],this.elements[a]),this.isActive[a]=!0);return this},u=function(a,c){if(a)switch($.type(a)){case "number":c?q.call(this,a):p.call(this,a);
break;case "array":for(var b=a.length;b--;)if("number"===$.type(b))c?q.call(this,b):p.call(this,b);else throw Error("Value passed in is not of valid type, must be an array of indexes.");break;default:throw Error("Value passed in is not of valid type, must be an index.");}else for(b=this.length;b--;)c?q.call(this,b):p.call(this,b);return this},n=function(a,c){switch($.type(a)){case "number":return c?this.elements[a]:this.players[a];case "string":for(var b,f=this.length;f--;)if(this.players[f].getAttribute("id")===
a){b=c?this.elements[f]:this.players[f];break}return b;case "array":b=[];for(var f=0,g=a.length;f<g;f++)c?b.push(n.call(this,a[f])):b.push(n.call(this,a[f],!0));return b;case "undefined":return c?this.elements:this.players;default:throw Error("Invalid parameter passed. Can be either the index (integer), id (string), or an array of either indices of ids")["break"];}},v=function(a){switch($.type(a)){case "number":return this.isActive[a];case "string":for(var c,b=this.length;b--;)if(this.players[b].getAttribute("id")===
a){c=this.isActive[b];break}return c;case "array":c=[];for(var b=0,f=a.length;b<f;b++)c.push(v.call(this,a[b]));return c;case "htmldivelement":for(b=this.length;b--;)if(this.players[b]===a){c=this.isActive[b];break}return c;case "undefined":return this.isActive;default:throw Error("Invalid parameter passed. Can be either the index (integer), id (string), or an array of either indices of ids")["break"];}};r.prototype={active:function(a){return v.call(this,a)},add:function(a){return u.call(this,a,!0)},
element:function(a){return n.call(this,a,!0)},player:function(a){return n.call(this,a)},remove:function(a){return u.call(this,a,!1)}};$.fn.extend({videoPlease:function(a){for(var c=[],b=0;b<this.length;b++)c.push(this[b]);return new r(c,a)}})})(window,document);
